{# Required parameters: id, legend, fields, errors, label_class, disabled #}

<div id="{{ id_ }}" name="{{ name }}" class="form-group {{ class_ }} {% if errors %}form-group-error{% endif %}">
  {% if fields|length == 1 %}
    {{ fields[0](disabled=disabled) }}
  {% else %}
  <fieldset {% if id == 'areas-covered' %}class="uk-countries"{% endif %}>
    <legend>
      {{- field.label.text }} {% if errors %}<span class="error-message">{{ errors[0] }}</span>{% endif -%}
    </legend>
      {% for field in fields %}
          {% set field_options = {"disabled": disabled} %}
          {% if loop.last and other_field %}
            {% do field_options.update({"disabled": disabled, "aria-controls": other_field.id + "-wrapper", "aria-expanded": "false"}) %}
          {% endif %}
          {{ field(**field_options) }}
      {% endfor %}
      
      {% if other_field %}
        <div class="panel panel-border-narrow form-group {% if other_field.errors %}form-group-error{% endif %}"
              id="{{ other_field.id }}-wrapper">
          {{ other_field(disabled=disabled) }}
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                showHideControl(document.getElementById("{{ fields[-1].id }}"))
            })
        </script>
      {% endif %}
  </fieldset>
  {% endif %}
</div>
