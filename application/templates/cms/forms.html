{% macro render_textarea_field(field, rows='10', cols='100', diffs={}, disabled=False, hint=None) -%}
  {% with field=field, id_=field.id, name=field.name, class_="", diffs=diffs, disabled=disabled, type="", disabled=disabled, textarea=true, hint=hint, value=field.data or "", field_params=((("cols=" + cols + " ") if cols else "") + (("rows=" + rows + " ") if rows else ""))|safe %}
    {% include "forms/_text_input.html" %}
  {% endwith %}
{%- endmacro %}


{% macro render_field(field, disabled=False, label_class=None, class="", hint=None, diffs={}) -%}
  {# Deprecated - use a custom RDU form field (e.g. RDUTextField) and render directly with `{{ form.field }}` in a jinja template #}
  
    {% if label_class %}
        {{ field.label(class=label_class) }}
    {% else %}
        {{ field.label }}
    {% endif %}

    {% if field.errors %}
        <span class="error-message">{{ field.errors[0] }}</span>
        {{ field(class="error " + class) }}
        {% if diffs %}
            <p>Your update to "{{ field.label.text }}" is highlighted green
                and possible deletions are highlighted red. If these changes are fine,
                save the page, otherwise edit the copy above and then save.</p>
            <div class="differences">
                {{ diffs[field.name] | render_markdown }}
            </div>
        {% endif %}
    {% else %}
        {% if hint %}
            <span class="form-hint">{{ hint }}</span>
        {% endif %}
        {{ field(disabled=disabled, class=class) }}
    {% endif %}
{%- endmacro %}


{% macro render_version_radio(field, measure) -%}
  {# Unique macro - do not reuse. Use RDURadioField in a WTForm and render the field directly with `{{ form.field }}` in a jinja template #}
  
    <label>
        {{ field }}
        <b>{{ measure.next_version_number_by_type(field.data) }}</b>
        {% if field.data == 'minor' %}
            Edit this edition (eg for clarifications or corrections)
        {% else %}
            Create new edition (eg after new data becomes available)
        {% endif %}
    </label>
{%- endmacro %}

{% macro render_checkboxes(fields, legend, disabled=False, label_class=None, class="", errors=False, legend_class="") -%}
    {# Deprecated - use RDUCheckboxField in a WTForm and render the field directly with `{{ form.field }}` in a jinja template #}
    
    {% set id = legend | lower | replace(' ', '-') %}
    <div class="form-group {% if errors %}form-group-error{% endif %}" id="{{ id }}">
        <fieldset class="{{ legend_class }}">
            <legend>{{ legend }}
                {% if errors %}
                    <span class="error-message">Select at least one</span>
                {% endif %}
            </legend>
            {% for field in fields %}
                <div class="multiple-choice">
                    {{ field(disabled=disabled, class=class) }}
                    {% if label_class %}
                        {{ field.label(class=label_class) }}
                    {% else %}
                        {{ field.label }}
                    {% endif %}
                </div>
            {% endfor %}
        </fieldset>
    </div>
{%- endmacro %}

{% macro render_department_select(label,
                                  form_field,
                                  current_selected_id,
                                  organisations_by_type,
                                  disabled=False,
                                  field_id=none,
                                  field_name=none,
                                  hint=None) %}

        {# Not using a wtforms select field as they do not support optgroups out of the box #}
        <div class="form-group">
            <label class="form-label" for="{{ field_id }}">
                {{ label }}
                {% if hint %}
                    <span class="form-hint">{{ hint }}</span>
                {% endif %}
            </label>

            {% if form_field.errors %}
                <span class="error-message">This field is required</span>
            {% endif %}
            <select class="form-control publisher" id="{{ field_id }}" name="{{ field_name }}" {% if disabled %}disabled{% endif %}>
              <option selected disabled>Please select</option>
              {% for type_of_org in organisations_by_type %}
                  <optgroup label="{{ type_of_org[0].pluralise() }}">
                    {% for org in type_of_org[1] %}
                        <option {% if org.id == current_selected_id %}selected{% endif %} value="{{ org.id }}"
                                data-abbreviations="{{ org.abbreviations_data() }}"
                                data-other-names="{{ org.other_names_data() }}">{{ org.name }}</option>
                    {% endfor %}
                  </optgroup>
              {% endfor %}
        </select>
    </div>
{%- endmacro %}
